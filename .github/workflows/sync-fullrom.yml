name: Sync UEFI Full ROMs

on:
  schedule:
    - cron: '0 0 * * *'  # Daily at midnight UTC
  workflow_dispatch:

permissions:
  contents: write

jobs:
  sync-roms:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout repository
      uses: actions/checkout@v4

    - name: Prepare directories
      run: mkdir -p fullrom

    - name: Download and verify ROMs
      id: sync
      run: |
        set -e
        base_url="https://www.mrchromebox.tech/files/firmware/full_rom/"

        files=(
        "coreboot_edk2-butterfly-mrchromebox_20250427.rom"
        "coreboot_edk2-lumpy-mrchromebox_20250427.rom"
        "coreboot_edk2-link-mrchromebox_20250427.rom"
        "coreboot_edk2-parrot-mrchromebox_20250427.rom"
        "coreboot_edk2-stout-mrchromebox_20250427.rom"
        "coreboot_edk2-stumpy-mrchromebox_20250427.rom"
        "coreboot_edk2-falco-mrchromebox_20250427.rom"
        "coreboot_edk2-leon-mrchromebox_20250427.rom"
        "coreboot_edk2-mccloud-mrchromebox_20250427.rom"
        "coreboot_edk2-monroe-mrchromebox_20250427.rom"
        "coreboot_edk2-panther-mrchromebox_20250427.rom"
        "coreboot_edk2-peppy-mrchromebox_20250427.rom"
        "coreboot_edk2-tricky-mrchromebox_20250427.rom"
        "coreboot_edk2-wolf-mrchromebox_20250427.rom"
        "coreboot_edk2-zako-mrchromebox_20250427.rom"
        "coreboot_edk2-auron_paine-mrchromebox_20250427.rom"
        "coreboot_edk2-auron_yuna-mrchromebox_20250427.rom"
        "coreboot_edk2-buddy-mrchromebox_20250427.rom"
        "coreboot_edk2-gandof-mrchromebox_20250427.rom"
        "coreboot_edk2-guado-mrchromebox_20250427.rom"
        "coreboot_edk2-lulu-mrchromebox_20250427.rom"
        "coreboot_edk2-rikku-mrchromebox_20250427.rom"
        "coreboot_edk2-samus-mrchromebox_20250427.rom"
        "coreboot_edk2-tidus-mrchromebox_20250427.rom"
        "coreboot_edk2-banjo-mrchromebox_20250427.rom"
        "coreboot_edk2-candy-mrchromebox_20250427.rom"
        "coreboot_edk2-clapper-mrchromebox_20250427.rom"
        "coreboot_edk2-enguarde-mrchromebox_20250427.rom"
        "coreboot_edk2-glimmer-mrchromebox_20250427.rom"
        "coreboot_edk2-gnawty-mrchromebox_20250427.rom"
        "coreboot_edk2-heli-mrchromebox_20250427.rom"
        "coreboot_edk2-kip-mrchromebox_20250427.rom"
        "coreboot_edk2-ninja-mrchromebox_20250427.rom"
        "coreboot_edk2-orco-mrchromebox_20250427.rom"
        "coreboot_edk2-quawks-mrchromebox_20250427.rom"
        "coreboot_edk2-squawks-mrchromebox_20250427.rom"
        "coreboot_edk2-sumo-mrchromebox_20250427.rom"
        "coreboot_edk2-swanky-mrchromebox_20250427.rom"
        "coreboot_edk2-winky-mrchromebox_20250427.rom"
        "coreboot_edk2-banon-mrchromebox_20250427.rom"
        "coreboot_edk2-celes-mrchromebox_20250427.rom"
        "coreboot_edk2-cyan-mrchromebox_20250427.rom"
        "coreboot_edk2-edgar-mrchromebox_20250427.rom"
        "coreboot_edk2-kefka-mrchromebox_20250427.rom"
        "coreboot_edk2-reks-mrchromebox_20250427.rom"
        "coreboot_edk2-relm-mrchromebox_20250427.rom"
        "coreboot_edk2-setzer-mrchromebox_20250427.rom"
        "coreboot_edk2-terra-mrchromebox_20250427.rom"
        "coreboot_edk2-ultima-mrchromebox_20250427.rom"
        "coreboot_edk2-wizpig-mrchromebox_20250427.rom"
        "coreboot_edk2-asuka-mrchromebox_20250427.rom"
        "coreboot_edk2-caroline-mrchromebox_20250427.rom"
        "coreboot_edk2-cave-mrchromebox_20250427.rom"
        "coreboot_edk2-chell-mrchromebox_20250427.rom"
        "coreboot_edk2-lars-mrchromebox_20250427.rom"
        "coreboot_edk2-sentry-mrchromebox_20250427.rom"
        "coreboot_edk2-atlas-mrchromebox_20250427.rom"
        "coreboot_edk2-endeavour-mrchromebox_20250427.rom"
        "coreboot_edk2-eve-mrchromebox_20250427.rom"
        "coreboot_edk2-fizz-mrchromebox_20250427.rom"
        "coreboot_edk2-karma-mrchromebox_20250427.rom"
        "coreboot_edk2-leona-mrchromebox_20250427.rom"
        "coreboot_edk2-nami-mrchromebox_20250427.rom"
        "coreboot_edk2-nautilus-mrchromebox_20250427.rom"
        "coreboot_edk2-nocturne-mrchromebox_20250427.rom"
        "coreboot_edk2-shyvana-mrchromebox_20250427.rom"
        "coreboot_edk2-soraka-mrchromebox_20250427.rom"
        "coreboot_edk2-astronaut-mrchromebox_20250430.rom"
        "coreboot_edk2-babymega-mrchromebox_20250430.rom"
        "coreboot_edk2-babytiger-mrchromebox_20250430.rom"
        "coreboot_edk2-blacktip-mrchromebox_20250430.rom"
        "coreboot_edk2-blue-mrchromebox_20250430.rom"
        "coreboot_edk2-bruce-mrchromebox_20250430.rom"
        "coreboot_edk2-coral-mrchromebox_20250430.rom"
        "coreboot_edk2-electro-mrchromebox_20250430.rom"
        "coreboot_edk2-epaulette-mrchromebox_20250430.rom"
        "coreboot_edk2-lava-mrchromebox_20250430.rom"
        "coreboot_edk2-nasher-mrchromebox_20250430.rom"
        "coreboot_edk2-nasher360-mrchromebox_20250430.rom"
        "coreboot_edk2-pyro-mrchromebox_20250430.rom"
        "coreboot_edk2-rabbid-mrchromebox_20250430.rom"
        "coreboot_edk2-reef-mrchromebox_20250430.rom"
        "coreboot_edk2-robo-mrchromebox_20250430.rom"
        "coreboot_edk2-robo360-mrchromebox_20250430.rom"
        "coreboot_edk2-sand-mrchromebox_20250430.rom"
        "coreboot_edk2-santa-mrchromebox_20250430.rom"
        "coreboot_edk2-snappy-mrchromebox_20250430.rom"
        "coreboot_edk2-whitetip-mrchromebox_20250430.rom"
        "coreboot_edk2-ampton-mrchromebox_20250430.rom"
        "coreboot_edk2-apel-mrchromebox_20250430.rom"
        "coreboot_edk2-bloog-mrchromebox_20250430.rom"
        "coreboot_edk2-blooglet-mrchromebox_20250430.rom"
        "coreboot_edk2-blooguard-mrchromebox_20250430.rom"
        "coreboot_edk2-blorb-mrchromebox_20250430.rom"
        "coreboot_edk2-bluebird-mrchromebox_20250430.rom"
        "coreboot_edk2-bobba-mrchromebox_20250430.rom"
        "coreboot_edk2-bobba360-mrchromebox_20250430.rom"
        "coreboot_edk2-casta-mrchromebox_20250430.rom"
        "coreboot_edk2-dood-mrchromebox_20250521.rom"
        "coreboot_edk2-dorp-mrchromebox_20250430.rom"
        "coreboot_edk2-droid-mrchromebox_20250430.rom"
        "coreboot_edk2-fleex-mrchromebox_20250430.rom"
        "coreboot_edk2-foob-mrchromebox_20250521.rom"
        "coreboot_edk2-foob360-mrchromebox_20250521.rom"
        "coreboot_edk2-garfour-mrchromebox_20250430.rom"
        "coreboot_edk2-garg-mrchromebox_20250430.rom"
        "coreboot_edk2-garg360-mrchromebox_20250430.rom"
        "coreboot_edk2-grabbiter-mrchromebox_20250430.rom"
        "coreboot_edk2-laser-mrchromebox_20250430.rom"
        "coreboot_edk2-laser14-mrchromebox_20250430.rom"
        "coreboot_edk2-lick-mrchromebox_20250430.rom"
        "coreboot_edk2-meep-mrchromebox_20250430.rom"
        "coreboot_edk2-mimrock-mrchromebox_20250430.rom"
        "coreboot_edk2-nospike-mrchromebox_20250430.rom"
        "coreboot_edk2-orbatrix-mrchromebox_20250430.rom"
        "coreboot_edk2-phaser-mrchromebox_20250430.rom"
        "coreboot_edk2-phaser360-mrchromebox_20250430.rom"
        "coreboot_edk2-phaser360s-mrchromebox_20250430.rom"
        "coreboot_edk2-sparky-mrchromebox_20250430.rom"
        "coreboot_edk2-sparky360-mrchromebox_20250430.rom"
        "coreboot_edk2-vorticon-mrchromebox_20250430.rom"
        "coreboot_edk2-vortininja-mrchromebox_20250430.rom"
        "coreboot_edk2-akemi-mrchromebox_20250427.rom"
        "coreboot_edk2-ambassador-mrchromebox_20250502.rom"
        "coreboot_edk2-dooly-mrchromebox_20250502.rom"
        "coreboot_edk2-dragonair-mrchromebox_20250427.rom"
        "coreboot_edk2-drallion-mrchromebox_20250427.rom"
        "coreboot_edk2-dratini-mrchromebox_20250427.rom"
        "coreboot_edk2-duffy-mrchromebox_20250502.rom"
        "coreboot_edk2-faffy-mrchromebox_20250502.rom"
        "coreboot_edk2-genesis-mrchromebox_20250502.rom"
        "coreboot_edk2-helios-mrchromebox_20250427.rom"
        "coreboot_edk2-jinlon-mrchromebox_20250427.rom"
        "coreboot_edk2-kaisa-mrchromebox_20250502.rom"
        "coreboot_edk2-kindred-mrchromebox_20250427.rom"
        "coreboot_edk2-kled-mrchromebox_20250427.rom"
        "coreboot_edk2-kohaku-mrchromebox_20250427.rom"
        "coreboot_edk2-moonbuggy-mrchromebox_20250521.rom"
        "coreboot_edk2-nightfury-mrchromebox_20250427.rom"
        "coreboot_edk2-noibat-mrchromebox_20250502.rom"
        "coreboot_edk2-scout-mrchromebox_20250521.rom"
        "coreboot_edk2-wyvern-mrchromebox_20250502.rom"
        "coreboot_edk2-chronicler-mrchromebox_20250427.rom"
        "coreboot_edk2-collis-mrchromebox_20250427.rom"
        "coreboot_edk2-copano-mrchromebox_20250427.rom"
        "coreboot_edk2-delbin-mrchromebox_20250427.rom"
        "coreboot_edk2-drobit-mrchromebox_20250427.rom"
        "coreboot_edk2-eldrid-mrchromebox_20250427.rom"
        "coreboot_edk2-elemi-mrchromebox_20250427.rom"
        "coreboot_edk2-lillipup-mrchromebox_20250427.rom"
        "coreboot_edk2-lindar-mrchromebox_20250427.rom"
        "coreboot_edk2-voema-mrchromebox_20250427.rom"
        "coreboot_edk2-volet-mrchromebox_20250427.rom"
        "coreboot_edk2-volta-mrchromebox_20250427.rom"
        "coreboot_edk2-voxel-mrchromebox_20250427.rom"
        "coreboot_edk2-beadrix-mrchromebox_20250427.rom"
        "coreboot_edk2-beetley-mrchromebox_20250427.rom"
        "coreboot_edk2-blipper-mrchromebox_20250427.rom"
        "coreboot_edk2-bookem-mrchromebox_20250427.rom"
        "coreboot_edk2-boten-mrchromebox_20250427.rom"
        "coreboot_edk2-botenflex-mrchromebox_20250427.rom"
        "coreboot_edk2-boxy-mrchromebox_20250427.rom"
        "coreboot_edk2-bugzzy-mrchromebox_20250427.rom"
        "coreboot_edk2-cret-mrchromebox_20250427.rom"
        "coreboot_edk2-cret360-mrchromebox_20250427.rom"
        "coreboot_edk2-dexi-mrchromebox_20250427.rom"
        "coreboot_edk2-drawcia-mrchromebox_20250427.rom"
        "coreboot_edk2-drawlat-mrchromebox_20250427.rom"
        "coreboot_edk2-drawman-mrchromebox_20250427.rom"
        "coreboot_edk2-drawper-mrchromebox_20250427.rom"
        "coreboot_edk2-galith-mrchromebox_20250427.rom"
        "coreboot_edk2-galith360-mrchromebox_20250427.rom"
        "coreboot_edk2-gallop-mrchromebox_20250427.rom"
        "coreboot_edk2-galnat-mrchromebox_20250427.rom"
        "coreboot_edk2-galnat360-mrchromebox_20250427.rom"
        "coreboot_edk2-galtic-mrchromebox_20250427.rom"
        "coreboot_edk2-galtic360-mrchromebox_20250427.rom"
        "coreboot_edk2-kracko-mrchromebox_20250427.rom"
        "coreboot_edk2-kracko360-mrchromebox_20250427.rom"
        "coreboot_edk2-landia-mrchromebox_20250427.rom"
        "coreboot_edk2-landrid-mrchromebox_20250427.rom"
        "coreboot_edk2-lantis-mrchromebox_20250427.rom"
        "coreboot_edk2-madoo-mrchromebox_20250427.rom"
        "coreboot_edk2-magister-mrchromebox_20250427.rom"
        "coreboot_edk2-maglet-mrchromebox_20250427.rom"
        "coreboot_edk2-maglia-mrchromebox_20250427.rom"
        "coreboot_edk2-maglith-mrchromebox_20250427.rom"
        "coreboot_edk2-magma-mrchromebox_20250427.rom"
        "coreboot_edk2-magolor-mrchromebox_20250427.rom"
        "coreboot_edk2-magneto-mrchromebox_20250427.rom"
        "coreboot_edk2-magpie-mrchromebox_20250427.rom"
        "coreboot_edk2-metaknight-mrchromebox_20250427.rom"
        "coreboot_edk2-palutena-mrchromebox_20250427.rom"
        "coreboot_edk2-pasara-mrchromebox_20250427.rom"
        "coreboot_edk2-peezer-mrchromebox_20250427.rom"
        "coreboot_edk2-pirette-mrchromebox_20250427.rom"
        "coreboot_edk2-pirika-mrchromebox_20250427.rom"
        "coreboot_edk2-sasuke-mrchromebox_20250427.rom"
        "coreboot_edk2-sasukette-mrchromebox_20250427.rom"
        "coreboot_edk2-storo-mrchromebox_20250427.rom"
        "coreboot_edk2-storo360-mrchromebox_20250427.rom"
        "coreboot_edk2-taranza-mrchromebox_20250427.rom"
        "coreboot_edk2-anahera-mrchromebox_20250427.rom"
        "coreboot_edk2-banshee-mrchromebox_20250427.rom"
        "coreboot_edk2-crota-mrchromebox_20250427.rom"
        "coreboot_edk2-crota360-mrchromebox_20250427.rom"
        "coreboot_edk2-dochi-mrchromebox_20250427.rom"
        "coreboot_edk2-felwinter-mrchromebox_20250427.rom"
        "coreboot_edk2-gimble-mrchromebox_20250427.rom"
        "coreboot_edk2-kano-mrchromebox_20250427.rom"
        "coreboot_edk2-marasov-mrchromebox_20250427.rom"
        "coreboot_edk2-mithrax-mrchromebox_20250427.rom"
        "coreboot_edk2-omnigul-mrchromebox_20250427.rom"
        "coreboot_edk2-osiris-mrchromebox_20250427.rom"
        "coreboot_edk2-primus-mrchromebox_20250427.rom"
        "coreboot_edk2-redrix-mrchromebox_20250427.rom"
        "coreboot_edk2-redrix4es-mrchromebox_20250427.rom"
        "coreboot_edk2-taeko-mrchromebox_20250427.rom"
        "coreboot_edk2-taniks-mrchromebox_20250427.rom"
        "coreboot_edk2-vell-mrchromebox_20250427.rom"
        "coreboot_edk2-volmar-mrchromebox_20250427.rom"
        "coreboot_edk2-zavala-mrchromebox_20250427.rom"
        "coreboot_edk2-constitution-mrchromebox_20250427.rom"
        "coreboot_edk2-intrepid-mrchromebox_20250427.rom"
        "coreboot_edk2-kinox-mrchromebox_20250427.rom"
        "coreboot_edk2-kuldax-mrchromebox_20250427.rom"
        "coreboot_edk2-lisbon-mrchromebox_20250427.rom"
        "coreboot_edk2-moli-mrchromebox_20250427.rom"
        "coreboot_edk2-anraggar-mrchromebox_20250427.rom"
        "coreboot_edk2-anraggar360-mrchromebox_20250427.rom"
        "coreboot_edk2-craask-mrchromebox_20250427.rom"
        "coreboot_edk2-craaskana-mrchromebox_20250427.rom"
        "coreboot_edk2-craaskbowl-mrchromebox_20250427.rom"
        "coreboot_edk2-craaskino-mrchromebox_20250427.rom"
        "coreboot_edk2-craaskov-mrchromebox_20250427.rom"
        "coreboot_edk2-craaskvin-mrchromebox_20250427.rom"
        "coreboot_edk2-craasneto-mrchromebox_20250427.rom"
        "coreboot_edk2-craaswell-mrchromebox_20250528.rom"
        "coreboot_edk2-joxer-mrchromebox_20250427.rom"
        "coreboot_edk2-nereid-mrchromebox_20250427.rom"
        "coreboot_edk2-nivviks-mrchromebox_20250427.rom"
        "coreboot_edk2-pujjo-mrchromebox_20250427.rom"
        "coreboot_edk2-pujjo1e-mrchromebox_20250505.rom"
        "coreboot_edk2-pujjoflex-mrchromebox_20250427.rom"
        "coreboot_edk2-pujjoga-mrchromebox_20250613.rom"
        "coreboot_edk2-pujjogatwin-mrchromebox_20250613.rom"
        "coreboot_edk2-pujjoteen-mrchromebox_20250427.rom"
        "coreboot_edk2-pujjoteen15w-mrchromebox_20250427.rom"
        "coreboot_edk2-quandiso-mrchromebox_20250427.rom"
        "coreboot_edk2-quandiso360-mrchromebox_20250427.rom"
        "coreboot_edk2-riven-mrchromebox_20250528.rom"
        "coreboot_edk2-rudriks-mrchromebox_20250528.rom"
        "coreboot_edk2-uldren-mrchromebox_20250427.rom"
        "coreboot_edk2-uldren360-mrchromebox_20250427.rom"
        "coreboot_edk2-xivu-mrchromebox_20250427.rom"
        "coreboot_edk2-xivu360-mrchromebox_20250427.rom"
        "coreboot_edk2-yahiko-mrchromebox_20250427.rom"
        "coreboot_edk2-yavijo-mrchromebox_20250427.rom"
        "coreboot_edk2-yaviks-mrchromebox_20250505.rom"
        "coreboot_edk2-yavikso-mrchromebox_20250427.rom"
        "coreboot_edk2-yavilla-mrchromebox_20250427.rom"
        "coreboot_edk2-yavilly-mrchromebox_20250427.rom"
        "coreboot_edk2-aleena-mrchromebox_20250427.rom"
        "coreboot_edk2-barla-mrchromebox_20250427.rom"
        "coreboot_edk2-careena-mrchromebox_20250427.rom"
        "coreboot_edk2-kasumi-mrchromebox_20250427.rom"
        "coreboot_edk2-liara-mrchromebox_20250427.rom"
        "coreboot_edk2-treeya-mrchromebox_20250427.rom"
        "coreboot_edk2-berknip-mrchromebox_20250427.rom"
        "coreboot_edk2-dirinboz-mrchromebox_20250427.rom"
        "coreboot_edk2-ezkinil-mrchromebox_20250427.rom"
        "coreboot_edk2-gumboz-mrchromebox_20250427.rom"
        "coreboot_edk2-jelboz360-mrchromebox_20250427.rom"
        "coreboot_edk2-morphius-mrchromebox_20250427.rom"
        "coreboot_edk2-vilboz-mrchromebox_20250427.rom"
        "coreboot_edk2-woomax-mrchromebox_20250427.rom"
        "coreboot_edk2-dewatt-mrchromebox_20250427.rom"
        "coreboot_edk2-nipperkin-mrchromebox_20250427.rom"
        "coreboot_edk2-crystaldrift-mrchromebox_20250427.rom"
        "coreboot_edk2-frostflow-mrchromebox_20250427.rom"
        "coreboot_edk2-markarth-mrchromebox_20250427.rom"
        "coreboot_edk2-skyrim-mrchromebox_20250427.rom"
        "coreboot_edk2-whiterun-mrchromebox_20250427.rom"
        "seabios-link-mrchromebox_20180912.bin"
        "seabios-hswbdw_box-mrchromebox_20180912.bin"
        "seabios-hswbdw_book-mrchromebox_20180912.bin"
        "seabios-byt-mrchromebox_20180912.bin"
        "seabios-bsw-mrchromebox_20180912.bin"
        "seabios-skl-mrchromebox_20180912.bin"
        "seabios-apl-mrchromebox_20180912.bin"
        "seabios-kbl-mrchromebox_20250227.bin"
        "seabios-kbl_18-mrchromebox_20250227.bin"
        )

        changed=false

        for file in "${files[@]}"; do
          echo "Syncing $file"

          curl -sLO "${base_url}${file}.sha1"
          curl -sLO "${base_url}${file}"

          if ! sha1sum -c "${file}.sha1" > /dev/null 2>&1; then
            echo "âŒ SHA-1 verification failed for $file"
            exit 1
          fi

          if [ ! -f "fullrom/$file" ] || ! cmp -s "$file" "fullrom/$file"; then
            mv "$file" "fullrom/$file"
            changed=true
          else
            rm "$file"
          fi

          rm "${file}.sha1"
        done

        echo "changed=$changed" >> $GITHUB_OUTPUT

    - name: Commit updated files
      if: steps.sync.outputs.changed == 'true'
      run: |
        git config user.name "github-actions[bot]"
        git config user.email "41898282+github-actions[bot]@users.noreply.github.com"
        git add fullrom/
        git commit -m "Sync UEFI Full ROMs from MrChromebox"
        git push
